name: PureStack Audit System

on:
  push:
    branches: [ main ]
  pull_request:
    branches: [ main ]

jobs:
  audit-dotnet:
    runs-on: ubuntu-latest

    steps:
      - name: ğŸ“¥ Checkout Code
        uses: actions/checkout@v4

      - name: ğŸ” Audit .NET Structure
        run: |
          echo "Checking Critical Files..."
          if [ ! -f "src/PureStackLogistics/Program.cs" ]; then echo "âŒ Missing Program.cs"; exit 1; fi
          if [ ! -f "src/PureStackLogistics/Services/InventoryService.cs" ]; then echo "âŒ Missing InventoryService.cs"; exit 1; fi
          if [ ! -f "tests/PureStackLogistics.Tests/InventoryTests.cs" ]; then echo "âŒ Missing Tests"; exit 1; fi
          echo "âœ… .NET Project Structure Validated."

      - name: ğŸ”§ Setup .NET Core
        uses: actions/setup-dotnet@v4
        with:
          dotnet-version: '8.0.x'

      - name: ğŸ“¦ Restore Dependencies
        run: dotnet restore

      - name: ğŸ—ï¸ Build Project
        run: dotnet build --no-restore

      - name: ğŸ§ª Run Tests (Smoke Check)
        run: dotnet test --no-build --verbosity normal
